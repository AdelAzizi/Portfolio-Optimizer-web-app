# Requirements Document

## Introduction

این سند نیازمندی‌های توسعه یک وب اپلیکیشن تعاملی برای نمایش و انتخاب استراتژی‌های سرمایه‌گذاری در بازار بورس ایران را تعریف می‌کند. این وب اپ داده‌های تولید شده توسط پایپ‌لاین موجود Python را مصرف کرده و آن‌ها را به صورت بصری جذاب و تعاملی به کاربران ارائه می‌دهد.

## Requirements

### Requirement 1: صفحه اصلی انتخاب استراتژی

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم بتوانم سه استراتژی سرمایه‌گذاری (دفاعی، متعادل، تهاجمی) را به صورت بصری جذاب مشاهده کنم تا بتوانم بر اساس پروفایل ریسک خودم انتخاب کنم.

#### Acceptance Criteria

1. WHEN کاربر وارد صفحه اصلی می‌شود THEN سیستم SHALL سه کارت استراتژی را در کنار هم نمایش دهد
2. WHEN کاربر صفحه را مشاهده می‌کند THEN هر کارت SHALL شامل طرح کاریکاتوری واقع‌گرایانه حیوان مربوطه که با پس‌زمینه کارت ترکیب شده، نام خلاقانه استراتژی و شعار کوتاه باشد
3. WHEN کاربر موس را روی هر کارت می‌برد THEN کارت SHALL به صورت انیمیشنی بزرگتر شده و اطلاعات تکمیلی نمایش داده شود
4. WHEN کارت در حالت hover قرار می‌گیرد THEN سیستم SHALL داستان استراتژی، نمودار فاکتورها و دعوت به اقدام را نمایش دهد
5. WHEN کاربر روی یک کارت کلیک می‌کند THEN آن کارت SHALL به عنوان انتخاب شده علامت‌گذاری شود

### Requirement 2: نمایش اطلاعات تفصیلی استراتژی‌ها

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم اطلاعات تفصیلی هر استراتژی شامل داستان، ترکیب فاکتورها و ویژگی‌ها را مشاهده کنم تا تصمیم آگاهانه‌ای بگیرم.

#### Acceptance Criteria

1. WHEN کاربر موس را روی کارت لاک‌پشت دانا می‌برد THEN سیستم SHALL داستان محافظه‌کارانه و فاکتورهای ارزش ۷۰%، مومنتوم ۲۰%، ریسک‌کم ۱۰% را نمایش دهد
2. WHEN کاربر موس را روی کارت گرگ باتجربه می‌برد THEN سیستم SHALL داستان متعادل و فاکتورهای ارزش ۳۰%، مومنتوم ۵۰%، ریسک‌کم ۲۰% را نمایش دهد
3. WHEN کاربر موس را روی کارت شاهین تیزبین می‌برد THEN سیستم SHALL داستان تهاجمی و فاکتورهای ارزش ۵%، مومنتوم ۹۰%، ریسک‌کم ۵% را نمایش دهد
4. WHEN فاکتورها نمایش داده می‌شوند THEN سیستم SHALL آن‌ها را به صورت نوار پیشرفت رنگی و زیبا نمایش دهد
5. WHEN اطلاعات تکمیلی نمایش داده می‌شود THEN انیمیشن‌ها SHALL نرم و روان باشند

### Requirement 3: انتخاب و تأیید استراتژی

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم بتوانم یک استراتژی را انتخاب کرده و به صفحه نتایج تفصیلی آن بروم تا سبد سهام پیشنهادی را مشاهده کنم.

#### Acceptance Criteria

1. WHEN کاربر روی یک کارت کلیک می‌کند THEN آن کارت SHALL با حاشیه رنگی مشخص به عنوان انتخاب شده علامت‌گذاری شود
2. WHEN کاربر استراتژی را انتخاب می‌کند THEN دکمه "ساخت سبد شخصی من" SHALL در پایین صفحه فعال و قابل مشاهده شود
3. WHEN کاربر روی دکمه "ساخت سبد شخصی من" کلیک می‌کند THEN سیستم SHALL او را به صفحه نتایج تفصیلی هدایت کند
4. IF کاربر هیچ استراتژی انتخاب نکرده باشد THEN دکمه "ساخت سبد شخصی من" SHALL غیرفعال باشد
5. WHEN کاربر استراتژی جدیدی انتخاب می‌کند THEN انتخاب قبلی SHALL لغو شده و استراتژی جدید انتخاب شود

### Requirement 4: صفحه نتایج و نمایش سبد سهام

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم پس از انتخاب استراتژی، سبد سهام پیشنهادی، عملکرد تاریخی و آمار کلیدی را مشاهده کنم تا درک کاملی از سرمایه‌گذاری خود داشته باشم.

#### Acceptance Criteria

1. WHEN کاربر وارد صفحه نتایج می‌شود THEN سیستم SHALL اطلاعات استراتژی انتخاب شده را از فایل JSON بارگذاری کند
2. WHEN داده‌ها بارگذاری می‌شوند THEN سیستم SHALL نام و آیکون استراتژی انتخاب شده را در بالای صفحه نمایش دهد
3. WHEN صفحه نتایج نمایش داده می‌شود THEN سیستم SHALL سبد سهام با وزن‌های پیشنهادی را به صورت جدول یا نمودار نمایش دهد
4. WHEN عملکرد نمایش داده می‌شود THEN سیستم SHALL آمار کلیدی شامل بازده کل، نسبت شارپ، نوسانات سالانه را نمایش دهد
5. WHEN داده‌های بک‌تست موجود باشد THEN سیستم SHALL نمودار عملکرد تاریخی را رسم کند

### Requirement 5: واکنش‌گرایی و تجربه کاربری

**User Story:** به عنوان یک کاربر، می‌خواهم وب اپ در تمام دستگاه‌ها (موبایل، تبلت، دسکتاپ) به خوبی کار کند و تجربه کاربری روان و جذابی داشته باشم.

#### Acceptance Criteria

1. WHEN کاربر از دستگاه موبایل استفاده می‌کند THEN کارت‌ها SHALL به صورت عمودی چیده شوند
2. WHEN کاربر از دستگاه تبلت استفاده می‌کند THEN کارت‌ها SHALL در دو ردیف مناسب چیده شوند
3. WHEN کاربر از دستگاه دسکتاپ استفاده می‌کند THEN کارت‌ها SHALL در یک ردیف افقی نمایش داده شوند
4. WHEN صفحه در حال بارگذاری است THEN سیستم SHALL یک انیمیشن بارگذاری مناسب نمایش دهد
5. WHEN خطایی در بارگذاری داده‌ها رخ دهد THEN سیستم SHALL پیام خطای مناسب و راهنمای رفع مشکل نمایش دهد

### Requirement 6: یکپارچگی با داده‌های موجود

**User Story:** به عنوان یک توسعه‌دهنده، می‌خواهم وب اپ بتواند داده‌های تولید شده توسط پایپ‌لاین Python موجود را مصرف کند تا نیازی به تغییر در سیستم موجود نباشد.

#### Acceptance Criteria

1. WHEN وب اپ راه‌اندازی می‌شود THEN سیستم SHALL فایل `final_results.json` را از GitHub Pages دانلود کرده و پردازش کند
2. WHEN داده‌های JSON پردازش می‌شوند THEN سیستم SHALL اطلاعات سه استراتژی Defensive، Balanced، Aggressive را استخراج کند
3. WHEN اطلاعات استراتژی استخراج می‌شود THEN سیستم SHALL وزن‌های سهام، آمار عملکرد و داده‌های بک‌تست را تفکیک کند
4. IF فایل JSON از GitHub Pages در دسترس نباشد THEN سیستم SHALL از نسخه کش شده محلی استفاده کند
5. IF هیچ داده‌ای در دسترس نباشد THEN سیستم SHALL پیام خطای مناسب نمایش دهد
6. WHEN داده‌های جدید در GitHub Pages قرار می‌گیرد THEN وب اپ SHALL به صورت خودکار داده‌های جدید را دریافت و نمایش دهد

### Requirement 7: صفحه نتایج تفصیلی و تحلیل عمیق

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم در صفحه نتایج، علاوه بر سبد پیشنهادی، اطلاعات تفصیلی شامل هزینه‌های معاملاتی، تاریخچه موازنه مجدد و تحلیل‌های عمیق‌تر را مشاهده کنم.

#### Acceptance Criteria

1. WHEN صفحه نتایج نمایش داده می‌شود THEN سیستم SHALL کارت‌های KPI شامل بازده سالانه، ریسک سالانه، نسبت شارپ و آلفا را نمایش دهد
2. WHEN ترکیب سبد نمایش داده می‌شود THEN سیستم SHALL یک نمودار دایره‌ای و جدول تفصیلی وزن‌های سهام را ارائه دهد
3. WHEN اطلاعات هزینه‌ها نمایش داده می‌شود THEN سیستم SHALL گردش سالانه سبد و هزینه تخمینی معاملات را نشان دهد
4. WHEN تاریخچه موازنه مجدد نمایش داده می‌شود THEN سیستم SHALL جدولی با تاریخ، سهام فروخته/خریداری شده و هزینه‌های هر دوره را ارائه دهد
5. WHEN کاربر روی آیکون‌های راهنما کلیک می‌کند THEN سیستم SHALL توضیحات ساده و قابل فهم برای هر مفهوم نمایش دهد

### Requirement 8: سیستم اطلاع‌رسانی و یادآوری

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم بتوانم ایمیل خود را ثبت کنم تا در زمان موازنه مجدد سبد، یادآوری دریافت کنم و از تغییرات مهم بازار مطلع شوم.

#### Acceptance Criteria

1. WHEN کاربر در صفحه نتایج قرار دارد THEN سیستم SHALL بخش "گام‌های بعدی" با تاریخ موازنه بعدی را نمایش دهد
2. WHEN کاربر ایمیل خود را وارد می‌کند THEN سیستم SHALL آن را در دیتابیس همراه با استراتژی انتخابی و تاریخ موازنه ذخیره کند
3. WHEN تاریخ موازنه مجدد فرا می‌رسد THEN سیستم SHALL به صورت خودکار ایمیل یادآوری ارسال کند
4. WHEN تغییرات مهم بازار رخ می‌دهد THEN سیستم SHALL به کاربران مشترک اطلاع‌رسانی کند
5. WHEN کاربر درخواست لغو اشتراک می‌کند THEN سیستم SHALL او را از لیست اطلاع‌رسانی حذف کند

### Requirement 9: احراز هویت و مدیریت کاربران

**User Story:** به عنوان یک کاربر، می‌خواهم بتوانم حساب کاربری ایجاد کنم تا سبدهای شخصی‌ام ذخیره شده و تجربه شخصی‌سازی شده‌ای داشته باشم.

#### Acceptance Criteria

1. WHEN کاربر جدید وارد سیستم می‌شود THEN سیستم SHALL امکان ثبت‌نام با ایمیل و رمز عبور را فراهم کند
2. WHEN کاربر ثبت‌نام می‌کند THEN سیستم SHALL حساب کاربری ایجاد کرده و توکن دسترسی صادر کند
3. WHEN کاربر مجدد وارد می‌شود THEN سیستم SHALL امکان ورود با اعتبارنامه‌های قبلی را فراهم کند
4. WHEN کاربر وارد شده است THEN سیستم SHALL سبدهای قبلی او را نمایش دهد
5. WHEN کاربر غیرمجاز درخواست ارسال می‌کند THEN سیستم SHALL دسترسی را رد کرده و پیام خطای مناسب نمایش دهد

### Requirement 10: بک‌اند API و زیرساخت

**User Story:** به عنوان یک توسعه‌دهنده، می‌خواهم یک API امن و قابل اعتماد داشته باشم که بتواند بار کاری بالا را مدیریت کند و از سوءاستفاده محافظت شود.

#### Acceptance Criteria

1. WHEN درخواست‌های متعدد از یک کاربر می‌آید THEN سیستم SHALL محدودیت نرخ (rate limiting) اعمال کند
2. WHEN درخواست تکراری با پارامترهای یکسان می‌آید THEN سیستم SHALL نتیجه را از کش بازگرداند
3. WHEN اطلاعات حساس مدیریت می‌شود THEN سیستم SHALL از متغیرهای محیطی و رمزگذاری استفاده کند
4. WHEN سیستم در محیط‌های مختلف اجرا می‌شود THEN پیکربندی‌ها SHALL از فایل‌های محیطی خوانده شوند
5. WHEN خطا در سیستم رخ می‌دهد THEN لاگ‌های مفصل و قابل ردیابی ثبت شوند

### Requirement 11: ذخیره‌سازی داده‌ها و مدیریت سبدها

**User Story:** به عنوان یک کاربر، می‌خواهم سبدهای ایجاد شده‌ام ذخیره شده و قابل بازیابی باشند تا بتوانم پیشرفت سرمایه‌گذاری‌ام را پیگیری کنم.

#### Acceptance Criteria

1. WHEN کاربر سبد جدیدی ایجاد می‌کند THEN سیستم SHALL آن را در دیتابیس با شناسه کاربر ذخیره کند
2. WHEN کاربر وارد حساب خود می‌شود THEN سیستم SHALL تمام سبدهای قبلی او را نمایش دهد
3. WHEN اطلاعات سبد به‌روزرسانی می‌شود THEN سیستم SHALL تاریخچه تغییرات را حفظ کند
4. WHEN کاربر سبدی را حذف می‌کند THEN سیستم SHALL تأیید گرفته و عملیات را انجام دهد
5. WHEN داده‌ها پشتیبان‌گیری می‌شوند THEN سیستم SHALL از امنیت و یکپارچگی اطلاعات اطمینان حاصل کند

### Requirement 12: بهینه‌سازی عملکرد و امنیت

**User Story:** به عنوان یک کاربر، می‌خواهم وب اپ سریع بارگذاری شود و اطلاعات من به صورت امن مدیریت شود.

#### Acceptance Criteria

1. WHEN کاربر وارد وب اپ می‌شود THEN صفحه اصلی SHALL در کمتر از ۳ ثانیه بارگذاری شود
2. WHEN تصاویر و انیمیشن‌ها نمایش داده می‌شوند THEN آن‌ها SHALL بهینه‌سازی شده و سبک باشند
3. WHEN کاربر بین صفحات جابجا می‌شود THEN انتقال SHALL روان و بدون تأخیر محسوس باشد
4. WHEN داده‌ها از سرور دریافت می‌شوند THEN ارتباط SHALL از پروتکل HTTPS استفاده کند
5. WHEN وظایف زمان‌بندی شده اجرا می‌شوند THEN سیستم SHALL به صورت خودکار و قابل اعتماد عمل کند

### Requirement 13: تجربه کاربری پیشرفته و شخصی‌سازی

**User Story:** به عنوان یک کاربر، می‌خواهم تجربه شخصی‌سازی شده‌ای داشته باشم و بتوانم تنظیمات خود را مدیریت کنم.

#### Acceptance Criteria

1. WHEN کاربر وارد سیستم می‌شود THEN سیستم SHALL زبان کاربر را تشخیص داده و محتوا را به فارسی یا انگلیسی نمایش دهد
2. WHEN کاربر تم تاریک/روشن انتخاب می‌کند THEN سیستم SHALL تنظیمات را ذخیره کرده و در بازدیدهای بعدی اعمال کند
3. WHEN کاربر اولین بار وارد می‌شود THEN سیستم SHALL یک تور راهنمای تعاملی برای آشنایی با قابلیت‌ها ارائه دهد
4. WHEN کاربر در حال استفاده از سیستم است THEN نکات کمکی (tooltips) و راهنمای زنده در دسترس باشد
5. WHEN کاربر عملیات مهمی انجام می‌دهد THEN سیستم SHALL بازخورد بصری مناسب (موفقیت، خطا، هشدار) نمایش دهد

### Requirement 14: امنیت پیشرفته و حریم خصوصی

**User Story:** به عنوان یک کاربر، می‌خواهم اطمینان داشته باشم که اطلاعات شخصی‌ام محفوظ است و کنترل کاملی بر داده‌هایم دارم.

#### Acceptance Criteria

1. WHEN کاربر اطلاعات شخصی وارد می‌کند THEN سیستم SHALL داده‌ها را رمزگذاری کرده و طبق استانداردهای GDPR مدیریت کند
2. WHEN کاربر درخواست حذف حساب می‌کند THEN سیستم SHALL تمام داده‌های شخصی را به صورت کامل حذف کند
3. WHEN فعالیت مشکوک تشخیص داده می‌شود THEN سیستم SHALL حساب را موقتاً مسدود کرده و به کاربر اطلاع دهد
4. WHEN کاربر از مکان جدیدی وارد می‌شود THEN سیستم SHALL ایمیل تأیید هویت ارسال کند
5. WHEN داده‌ها پردازش می‌شوند THEN سیستم SHALL لاگ کاملی از دسترسی‌ها برای audit نگهداری کند

### Requirement 15: عملکرد و مقیاس‌پذیری

**User Story:** به عنوان یک کاربر، می‌خواهم سیستم حتی در ساعات پرترافیک نیز سریع و پایدار باشد.

#### Acceptance Criteria

1. WHEN تعداد کاربران همزمان بالا باشد THEN سیستم SHALL بدون کاهش عملکرد پاسخ دهد
2. WHEN حجم داده‌ها افزایش می‌یابد THEN سیستم SHALL به صورت خودکار منابع را مقیاس‌بندی کند
3. WHEN خطا در یک بخش رخ می‌دهد THEN سایر بخش‌ها SHALL بدون وقفه کار کنند (fault tolerance)
4. WHEN بک‌آپ‌گیری انجام می‌شود THEN عملیات SHALL بدون تأثیر بر عملکرد سیستم انجام شود
5. WHEN سیستم به‌روزرسانی می‌شود THEN فرآیند SHALL بدون قطعی سرویس (zero-downtime deployment) انجام شود

### Requirement 16: تحلیل‌های پیشرفته و هوش تجاری

**User Story:** به عنوان یک سرمایه‌گذار، می‌خواهم تحلیل‌های عمیق‌تر و پیش‌بینی‌هایی برای آینده سبدم دریافت کنم.

#### Acceptance Criteria

1. WHEN کاربر سبد خود را مشاهده می‌کند THEN سیستم SHALL تحلیل ریسک سکتوری و تنوع‌بخشی نمایش دهد
2. WHEN داده‌های جدید بازار دریافت می‌شود THEN سیستم SHALL تأثیر احتمالی بر سبد کاربر را محاسبه و نمایش دهد
3. WHEN کاربر درخواست پیش‌بینی می‌کند THEN سیستم SHALL سناریوهای مختلف بازار و تأثیر آن‌ها را شبیه‌سازی کند
4. WHEN عملکرد سبد تحلیل می‌شود THEN سیستم SHALL مقایسه با شاخص‌های مختلف بازار و سبدهای مشابه ارائه دهد
5. WHEN کاربر تصمیم‌گیری می‌کند THEN سیستم SHALL توصیه‌های شخصی‌سازی شده بر اساس تاریخچه و ترجیحات ارائه دهد

### Requirement 17: یکپارچگی و قابلیت توسعه

**User Story:** به عنوان یک توسعه‌دهنده، می‌خواهم سیستم قابلیت اتصال به سرویس‌های خارجی و توسعه آینده را داشته باشد.

#### Acceptance Criteria

1. WHEN سرویس‌های خارجی (مثل کارگزاری‌ها) متصل می‌شوند THEN سیستم SHALL API استاندارد و مستندات کاملی ارائه دهد
2. WHEN ماژول جدیدی اضافه می‌شود THEN معماری SHALL انعطاف‌پذیری لازم برای توسعه را فراهم کند
3. WHEN داده‌های real-time نیاز باشد THEN سیستم SHALL قابلیت اتصال به فیدهای زنده بازار را داشته باشد
4. WHEN گزارش‌های سفارشی درخواست می‌شود THEN سیستم SHALL امکان صادرات داده‌ها در فرمت‌های مختلف (PDF, Excel, CSV) را فراهم کند
5. WHEN تست‌های خودکار اجرا می‌شوند THEN سیستم SHALL پوشش تست بالای ۸۰٪ برای کدهای حیاتی داشته باشد